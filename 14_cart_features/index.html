<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>Dom</title>


    <style>

        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        .container{
            margin: auto;
            max-width: 1320px;
        }
        .d-flex{
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }

        .bigbox{
            width: 22%;
            padding: 10px;
       
        }

        .box{
            border-radius: 10px;
            height: 100%;
               box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.582);
               padding: 10px;
        }
        .box > img{
            width: 100%;
            height: 300px;
            border: 1px solid gainsboro;

        }
    </style>
</head>
<body>
  <nav class="navbar navbar-dark bg-dark fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Offcanvas dark navbar</a>
      <button onclick="showCart()" class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDarkNavbar" aria-controls="offcanvasDarkNavbar" aria-label="Toggle navigation">
        ðŸ›’: <b id="cartlength"></b>
      </button>
      <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasDarkNavbar" aria-labelledby="offcanvasDarkNavbarLabel">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel">Dark offcanvas</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <table class="table">
              <thead>
                <tr>
                  <th>img</th>
                  <th>title</th>
                  <th>price</th>
                  <th>btn</th>
                </tr>
              </thead>
              <tbody class="cart">

              </tbody>
           


            </table>
         
        </div>
      </div>
    </div>
  </nav>








    <div class="main" style="margin:40px auto; width:fit-content">
      <input type="text" id="search" style="padding:10px 20px; font-size:21px; border:1px solid gray">
    </div>

        <div class="buttons">
            <button id="viewall">all</button>
            <button id="mens">mens</button>
            <button id="jewelery">jewelery</button>
            <button id="price_sort">Price_Sort</button>
        </div>
    <div class="container">
        <div class="row row-cols-lg-4 g-4" id="boxes">
        </div>
    </div>





  

    
</body>

<script src="data.js"></script>

  
</script>



<script>





let search = document.getElementById("search")

  search.addEventListener("keyup", function(e){
    let val = e.target.value.toUpperCase();
    
    let searchData = data.filter((ele) => !ele.title.toUpperCase().indexOf(val) || !ele.category.toUpperCase().indexOf(val))
 console.log(searchData)

    showData(searchData);

  })





let boxes = document.querySelector("#boxes")


let mens= document.querySelector("#mens");
let viewall= document.querySelector("#viewall");
let jewelery = document.querySelector("#jewelery")
let price_sort = document.querySelector("#price_sort");



price_sort.addEventListener("click", ()=>{
    // let getData = data.map((ele) => ele.price.sort());

    data.sort((a, b) => a.price - b.price);
    let getData = data;
    showData(getData)

    // let , amul, joke, amit
    // amit, amul, let, joke
})

jewelery.addEventListener("click", ()=>{
    let getData = data.filter((ele)=> ele.category=="jewelery");
    showData(getData)
})

mens.addEventListener("click", ()=>{
   let getData = data.filter((ele) => ele.category=="men's clothing");
    console.log(getData) ;
    showData(getData)
})


viewall.addEventListener("click", ()=>{
   let getData = data.map((ele) => ele);
    console.log(getData) ;
    showData(getData)
})











let cartData = JSON.parse(localStorage.getItem("cartData")) || []

window.onload= showData(data);


function incCount(id){
    cartData =  cartData.map((ele) => {
      if(ele.id == id){
        ele.quentity += 1;
      }
      return ele;
    })

    localStorage.setItem("cartData", JSON.stringify(cartData));

    showCart();
}


function descCount(id){
    cartData =  cartData.map((ele) => {
      if(ele.id == id){
        if(ele.quentity >1){
              ele.quentity -= 1;
        }
    
      }
      return ele;
    })

    localStorage.setItem("cartData", JSON.stringify(cartData));

    showCart();
}

function addCart(id){

  let newcartData = data.filter((ele) => ele.id == id).map((ele) => {
    if(ele.id == id){
      ele.quentity = 1; 
    }
   return ele;
  })

  cartData = [...cartData, ...newcartData]
  console.log(cartData)
 
  setCartData(cartData)


  document.getElementById("cartlength").innerHTML = cartData.length

}


document.getElementById("cartlength").innerHTML = cartData.length;

function removeItem(id){
  // console.log(cartData);

  let remcartData = cartData.filter((ele) => ele.id != id);

showCart(remcartData);

 setCartData(remcartData)

  
}

const setCartData = (d) =>{
  localStorage.setItem("cartData", JSON.stringify(d))
}





function showData(getData){

        boxes.innerHTML = "";

    console.log(getData) ;

    getData.map((ele)=> {

     boxes.innerHTML += `
     <div class="col">
      <div class="card" style="width: 18rem;">
  <img style="height:400px" src=${ele.image} class="card-img-top" alt="...">
  <div class="card-body">
    <h5 class="card-title">${ele.title}</h5>
    <h6 class="sub-title">${ele.price}</h6>
    <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
    <button onclick="addCart(${ele.id})" class="btn btn-primary">add</button>
  </div>
</div>
</div>
     `
})

}



 cartData = JSON.parse(localStorage.getItem("cartData"))





function showCart(){
  let cart = document.querySelector(".cart");
  console.log(cartData)
  cart.innerHTML = "";

  cartData.map((ele) => {
  cart.innerHTML += `
             <tr>
                <td><img class="img-fluid" src=${ele.image} alt="${ele.title}" /></td>
                <td>${ele.title}</td>
                <td class="ptotal">${ele.price*ele.quentity}</td>
                <td><button onclick="incCount(${ele.id})" class="btn btn-dark btn-sm">+</button></td>
                <td><button class="btn btn-outline-dark btn-sm">${ele.quentity}</button></td>
                <td><button onclick="descCount(${ele.id})" class="btn btn-danger btn-sm">-</button></td>
                <td><button onclick="removeItem(${ele.id})" class="btn-close"></button></td>
              </tr>
  
  `
})

}



</script>
</html>